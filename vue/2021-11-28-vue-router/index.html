<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Vue Router - Zxd's Blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="zxd"><meta name=description content="Vue-Router Vue-Router-Base 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // router/index.js import Vue from &amp;#39;vue&amp;#39; import VueRouter from &amp;#39;vue-router&amp;#39; import Index from &amp;#39;../views/Index.vue&amp;#39; // 1. 注册路由插件 // Vue.use是"><meta name=keywords content="Hugo,theme,Zxd"><meta name=generator content="Hugo 0.81.0 with theme even"><link rel=canonical href=http://localhost:1313/vue/2021-11-28-vue-router/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><link href=/sass/main.min.8eca1510e0bf04006a123f0d7fcb8799b6e77ab2f264b44357a16e783b064b04.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Vue Router"><meta property="og:description" content="Vue-Router Vue-Router-Base 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // router/index.js import Vue from 'vue' import VueRouter from 'vue-router' import Index from '../views/Index.vue' // 1. 注册路由插件 // Vue.use是"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/vue/2021-11-28-vue-router/"><meta property="article:section" content="vue"><meta property="article:published_time" content="2021-11-28T12:04:40+08:00"><meta property="article:modified_time" content="2021-11-28T12:04:40+08:00"><meta itemprop=name content="Vue Router"><meta itemprop=description content="Vue-Router Vue-Router-Base 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // router/index.js import Vue from 'vue' import VueRouter from 'vue-router' import Index from '../views/Index.vue' // 1. 注册路由插件 // Vue.use是"><meta itemprop=datePublished content="2021-11-28T12:04:40+08:00"><meta itemprop=dateModified content="2021-11-28T12:04:40+08:00"><meta itemprop=wordCount content="3460"><meta itemprop=keywords content=","><meta name=twitter:card content="summary"><meta name=twitter:title content="Vue Router"><meta name=twitter:description content="Vue-Router Vue-Router-Base 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // router/index.js import Vue from 'vue' import VueRouter from 'vue-router' import Index from '../views/Index.vue' // 1. 注册路由插件 // Vue.use是"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>zxd's blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/vue/><li class=mobile-menu-item>Vue</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>zxd's blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/vue/>Vue</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><div class=post-content><h2 id=vue-router>Vue-Router</h2><h3 id=vue-router-base>Vue-Router-Base</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// router/index.js
</span><span class=c1></span>
<span class=kr>import</span> <span class=nx>Vue</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>import</span> <span class=nx>VueRouter</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
<span class=kr>import</span> <span class=nx>Index</span> <span class=nx>from</span> <span class=s1>&#39;../views/Index.vue&#39;</span>

<span class=c1>// 1. 注册路由插件
</span><span class=c1>// Vue.use是用来注册插件,接受一个参数,如果参数是函数,直接执行
</span><span class=c1>// 如果参数是对象, 调用传入对象的 install 方法
</span><span class=c1></span><span class=nx>Vue</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>VueRouter</span><span class=p>)</span>

<span class=c1>// 2. 定义routes路由规则
</span><span class=c1></span><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
  <span class=p>{</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Index&#39;</span><span class=p>,</span>
    <span class=nx>component</span><span class=o>:</span> <span class=nx>Index</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/detail/:id&#39;</span><span class=p>,</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Detail&#39;</span><span class=p>,</span>
    <span class=c1>// 开启 props，会把 URL 中的参数传递给组件
</span><span class=c1></span>    <span class=c1>// 在组件中通过 props 来接收 URL 参数
</span><span class=c1></span>    <span class=nx>props</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=c1>// route level code-splitting
</span><span class=c1></span>    <span class=c1>// this generates a separate chunk (about.[hash].js) for this route
</span><span class=c1></span>    <span class=c1>// which is lazy-loaded when the route is visited.
</span><span class=c1></span>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=cm>/* webpackChunkName: &#34;detail&#34; */</span> <span class=s1>&#39;../views/Detail.vue&#39;</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>]</span>

<span class=c1>// 创建 router 路由对象
</span><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>VueRouter</span><span class=p>({</span>
  <span class=nx>routes</span>
<span class=p>})</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// main.js
</span><span class=c1></span><span class=kr>import</span> <span class=nx>Vue</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
<span class=kr>import</span> <span class=nx>App</span> <span class=nx>from</span> <span class=s1>&#39;./App.vue&#39;</span>
<span class=kr>import</span> <span class=nx>router</span> <span class=nx>from</span> <span class=s1>&#39;./router&#39;</span>

<span class=nx>Vue</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>productionTip</span> <span class=o>=</span> <span class=kc>false</span>

<span class=k>new</span> <span class=nx>Vue</span><span class=p>({</span>
  <span class=c1>// 3. 注册 router 对象
</span><span class=c1></span>  <span class=nx>router</span><span class=p>,</span> <span class=c1>// 给vue实例注入两个对象 $route和$router
</span><span class=c1></span>  <span class=nx>render</span><span class=o>:</span> <span class=nx>h</span> <span class=p>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=nx>App</span><span class=p>)</span>
<span class=p>}).</span><span class=nx>$mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// app.vue
</span><span class=c1></span>  <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>id</span><span class=o>=</span><span class=s2>&#34;app&#34;</span><span class=o>&gt;</span>
    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
      <span class=o>&lt;</span><span class=nx>img</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;@/assets/logo.png&#34;</span> <span class=nx>alt</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=o>&gt;</span>
    <span class=o>&lt;</span><span class=err>/div&gt;</span>
    <span class=o>&lt;</span><span class=nx>div</span> <span class=nx>id</span><span class=o>=</span><span class=s2>&#34;nav&#34;</span><span class=o>&gt;</span>
      <span class=c>&lt;!--</span> <span class=mf>5.</span> <span class=nx>创建链接</span> <span class=o>--&gt;</span>
      <span class=o>&lt;</span><span class=nx>router</span><span class=o>-</span><span class=nx>link</span> <span class=nx>to</span><span class=o>=</span><span class=s2>&#34;/&#34;</span><span class=o>&gt;</span><span class=nx>Index</span><span class=o>&lt;</span><span class=err>/router-link&gt; |</span>
      <span class=o>&lt;</span><span class=nx>router</span><span class=o>-</span><span class=nx>link</span> <span class=nx>to</span><span class=o>=</span><span class=s2>&#34;/blog&#34;</span><span class=o>&gt;</span><span class=nx>Blog</span><span class=o>&lt;</span><span class=err>/router-link&gt; |</span>
      <span class=o>&lt;</span><span class=nx>router</span><span class=o>-</span><span class=nx>link</span> <span class=nx>to</span><span class=o>=</span><span class=s2>&#34;/photo&#34;</span><span class=o>&gt;</span><span class=nx>Photo</span><span class=o>&lt;</span><span class=err>/router-link&gt;</span>
    <span class=o>&lt;</span><span class=err>/div&gt;</span>
    <span class=c>&lt;!--</span> <span class=mf>4.</span> <span class=nx>创建路由组建的占位</span> <span class=o>--&gt;</span>
    <span class=o>&lt;</span><span class=nx>router</span><span class=o>-</span><span class=nx>view</span><span class=o>/&gt;</span>
  <span class=o>&lt;</span><span class=err>/div&gt;</span>
</code></pre></td></tr></table></div></div><h3 id=动态路由>动态路由</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
  <span class=p>{</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Index&#39;</span><span class=p>,</span>
    <span class=nx>component</span><span class=o>:</span> <span class=nx>Index</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/detail/:id&#39;</span><span class=p>,</span> <span class=c1>// 动态路由
</span><span class=c1></span>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Detail&#39;</span><span class=p>,</span>
    <span class=c1>// 开启 props，会把 URL 中的参数传递给组件
</span><span class=c1></span>    <span class=c1>// 在组件中通过 props 来接收 URL 参数
</span><span class=c1></span>    <span class=nx>props</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=c1>// route level code-splitting
</span><span class=c1></span>    <span class=c1>// this generates a separate chunk (about.[hash].js) for this route
</span><span class=c1></span>    <span class=c1>// which is lazy-loaded when the route is visited.
</span><span class=c1></span>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=cm>/* webpackChunkName: &#34;detail&#34; */</span> <span class=s1>&#39;../views/Detail.vue&#39;</span><span class=p>)</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></td></tr></table></div></div><h4 id=动态路由中获取参数>动态路由中获取参数</h4><ul><li>$route.params.id</li><li>props</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=c>&lt;!-- 方式1： 通过当前路由规则，获取数据 --&gt;</span>
    通过当前路由规则获取：{{ $route.params.id }}

    <span class=p>&lt;</span><span class=nt>br</span><span class=p>&gt;</span>
    <span class=c>&lt;!-- 方式2：路由规则中开启 props 传参 --&gt;</span>
    通过开启 props 获取：{{ id }}
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Detail&#39;</span><span class=p>,</span>
  <span class=nx>props</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span>
<span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><h3 id=嵌套路由>嵌套路由</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
  <span class=p>{</span>
    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
    <span class=nx>component</span><span class=o>:</span> <span class=nx>Login</span>
  <span class=p>},</span>
  <span class=c1>// 嵌套路由
</span><span class=c1></span>  <span class=p>{</span>
    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
    <span class=nx>component</span><span class=o>:</span> <span class=nx>Layout</span><span class=p>,</span>
    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
      <span class=p>{</span>
        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
        <span class=nx>component</span><span class=o>:</span> <span class=nx>Index</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;detail&#39;</span><span class=p>,</span>
        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;detail/:id&#39;</span><span class=p>,</span>
        <span class=nx>props</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
        <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;@/views/Detail.vue&#39;</span><span class=p>)</span>
      <span class=p>}</span>
    <span class=p>]</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></td></tr></table></div></div><h2 id=编程式导航>编程式导航</h2><ul><li><a href=https://router.vuejs.org/zh/guide/essentials/navigation.html>Vue-Router</a></li></ul><h3 id=routerpush>router.push</h3><p>该方法的参数可以是一个字符串路径，或者一个描述地址的对象</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// 字符串
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;home&#39;</span><span class=p>)</span>

<span class=c1>// 对象
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;home&#39;</span> <span class=p>})</span>

<span class=c1>// 命名的路由
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nx>params</span><span class=o>:</span> <span class=p>{</span> <span class=nx>userId</span><span class=o>:</span> <span class=s1>&#39;123&#39;</span> <span class=p>}})</span>

<span class=c1>// 带查询参数，变成 /register?plan=private
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;register&#39;</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=p>{</span> <span class=nx>plan</span><span class=o>:</span> <span class=s1>&#39;private&#39;</span> <span class=p>}})</span>
</code></pre></td></tr></table></div></div><h3 id=routerreplace>router.replace</h3><p>跟 router.push 很像，唯一的不同就是，它不会向 history 添加新记录，而是跟它的方法名一样 —— 替换掉当前的 history 记录。</p><h3 id=routergon>router.go(n)</h3><p>这个方法的参数是一个整数，意思是在 history 记录中向前或者后退多少步，类似 window.history.go(n)。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// 在浏览器记录中前进一步，等同于 history.forward()
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>

<span class=c1>// 后退一步记录，等同于 history.back()
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>

<span class=c1>// 前进 3 步记录
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>

<span class=c1>// 如果 history 记录不够用，那就默默地失败呗
</span><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=o>-</span><span class=mi>100</span><span class=p>)</span>
<span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><h2 id=hash-和-history-模式区别>Hash 和 History 模式区别</h2><ul><li>Hash 模式<ul><li><a href="https://music.go.com/#/playlist?id=001">https://music.go.com/#/playlist?id=001</a></li></ul></li><li>History 模式<ul><li><a href=https://music.go.com/playlist/001>https://music.go.com/playlist/001</a></li></ul></li></ul><h3 id=原理>原理</h3><ul><li><p>Hash 模式是基于锚点, 以及<code>onhashchange</code>事件</p></li><li><p>History 模式是基于HTML5中的History API</p><ul><li>history.pushState() IE10以后才支持</li><li>history.replaceState()</li><li>history.go()</li></ul></li><li><p>开启history模式</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>VueRouter</span><span class=p>({</span> 
 <span class=c1>// mode: &#39;hash&#39;,
</span><span class=c1></span> <span class=nx>mode</span><span class=o>:</span> <span class=s1>&#39;history&#39;</span><span class=p>,</span> 
 <span class=nx>routes</span>
<span class=p>})</span>
</code></pre></td></tr></table></div></div><p><strong>History 模式的使用</strong></p><ul><li>History 模式需要服务器支持</li><li>单页面应用中, 只有一个index.html 服务端不存在http://www.test.com/login等这样的地址,会返回找不到该页面</li><li>在服务端应该除了静态资源以外都返回单页面应用的index.html</li></ul><h3 id=nodejs中配置history模式>Node.js中配置history模式</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>)</span>
<span class=c1>// 导入处理 history 模式的模块
</span><span class=c1></span><span class=kr>const</span> <span class=nx>history</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;connect-history-api-fallback&#39;</span><span class=p>)</span>
<span class=c1>// 导入 express
</span><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>)</span>

<span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>()</span>
<span class=c1>// 注册处理 history 模式的中间件
</span><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>history</span><span class=p>())</span>
<span class=c1>// 处理静态资源的中间件，网站根目录 ../web
</span><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=kr>static</span><span class=p>(</span><span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s1>&#39;../web&#39;</span><span class=p>)))</span>

<span class=c1>// 开启服务器，端口是 3000
</span><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;服务器开启，端口：3000&#39;</span><span class=p>)</span>
<span class=p>})</span>

</code></pre></td></tr></table></div></div><h3 id=nginx中配置history模式>Nginx中配置history模式</h3><ul><li>从官网下载nginx压缩包</li><li>解压到某盘根目录</li><li>打开命令行,切换到nginx目录中 (不能有中文)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 启动</span>
start nginx
<span class=c1># 重启</span>
nginx -s reload
<span class=c1># 停止</span>
nginx -s stop
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># nginx.conf http-server-location</span>

location / <span class=o>{</span> 
 root   html<span class=p>;</span>
 index  index.html index.htm<span class=p>;</span> 
 <span class=c1>#新添加内容</span>
 <span class=c1>#尝试读取$uri(当前请求的路径)，如果读取不到读取$uri/这个文件夹下的首页 </span>
 <span class=c1>#如果都获取不到返回根目录中的    index.html</span>
 try_files <span class=nv>$uri</span> <span class=nv>$uri</span>/ /index.html<span class=p>;</span> 
<span class=o>}</span>

</code></pre></td></tr></table></div></div><h2 id=模拟实现vue-router>模拟实现Vue-Router</h2><h3 id=hash-模式-原理>Hash 模式 原理</h3><ul><li>URL 中 # 后面的内容作为路径地址</li><li>监听 hashchange 事件</li><li>根据当前路由地址找到对应组件重新渲染</li></ul><h3 id=history-模式-原理>History 模式 原理</h3><ul><li>通过 history.pushState() 方法改变地址栏<ul><li>pushState方法会把当前地址记录到浏览器的访问历史中, 并不会向服务器发送请求</li></ul></li><li>监听 popstate 事件</li><li>根据当前路由地址找到对应组件重新渲染</li></ul><h3 id=vue-router-1>Vue-Router</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// 1. 注册插件
</span><span class=c1>// Vue.use() 内部调用传入对象的 install 方法
</span><span class=c1></span><span class=nx>Vue</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>VueRouter</span><span class=p>)</span> 
<span class=c1>// 2. 创建路由对象
</span><span class=c1></span><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>VueRouter</span><span class=p>({</span> 
 <span class=nx>routes</span><span class=o>:</span> <span class=p>[{</span><span class=nx>name</span> <span class=o>:</span> <span class=s1>&#39;home&#39;</span><span class=p>,</span> <span class=nx>path</span><span class=o>:</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>homeComponent</span><span class=p>}]</span> 
<span class=p>})</span>
<span class=c1>// 3. 创建 Vue 实例，注册 router 对象 
</span><span class=c1></span><span class=k>new</span> <span class=nx>Vue</span><span class=p>({</span>
 <span class=nx>router</span><span class=p>,</span>
 <span class=nx>render</span><span class=o>:</span> <span class=nx>h</span> <span class=p>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=nx>App</span><span class=p>)</span> 
<span class=p>}).</span><span class=nx>$mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><ul><li>VueRouter类图
<img src=https://gtd-imgs-md.oss-cn-beijing.aliyuncs.com/imgs/20211128135341.png alt></li><li>options : 记录构造函数中传入的对象(new VueRouter传入的路由规则routes)</li><li>routeMap : 记录路由地址和组件的对应关系,将来会把路由规则解析到routeMap中</li><li>data : current 记录当前路由地址</li></ul><h3 id=_installvuevoid>_install(Vue):void</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kd>let</span> <span class=nx>_Vue</span> <span class=o>=</span> <span class=kc>null</span>
<span class=kr>class</span> <span class=nx>VueRouter</span> <span class=p>{</span>
    <span class=kr>static</span> <span class=nx>install</span> <span class=p>(</span><span class=nx>Vue</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// 1. 判断当前插件是否已经被安装
</span><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>VueRouter</span><span class=p>.</span><span class=nx>install</span><span class=p>.</span><span class=nx>installed</span><span class=p>)</span> <span class=k>return</span>
        <span class=nx>VueRouter</span><span class=p>.</span><span class=nx>install</span><span class=p>.</span><span class=nx>installed</span> <span class=o>=</span> <span class=kc>true</span>
        <span class=c1>// 2. 把Vue构造函数记录到全局变量
</span><span class=c1></span>        <span class=nx>_Vue</span> <span class=o>=</span> <span class=nx>Vue</span>
        <span class=c1>// 3. 把创建Vue实例时候传入的router对象注入到Vue实例上
</span><span class=c1></span>        <span class=c1>// _Vue.prototype.$router = this.$options.router
</span><span class=c1></span>        <span class=c1>// 混入
</span><span class=c1></span>        <span class=nx>_Vue</span><span class=p>.</span><span class=nx>mixin</span><span class=p>({</span>
            <span class=nx>beforeCreate</span><span class=p>()</span> <span class=p>{</span>
                <span class=c1>// 如果是Vue实例执行,组件就不执行了
</span><span class=c1></span>                <span class=c1>// 只有Vue实例的$options里才有router对象
</span><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>$options</span><span class=p>.</span><span class=nx>router</span><span class=p>)</span> <span class=p>{</span>
                    <span class=nx>_Vue</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>$router</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>$options</span><span class=p>.</span><span class=nx>router</span>
                <span class=p>}</span>
            <span class=p>},</span>
        <span class=p>})</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kr>export</span> <span class=k>default</span> <span class=nx>VueRouter</span>
</code></pre></td></tr></table></div></div><h3 id=constructoroptionsvuerouter>Constructor(Options):VueRouter</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js>    <span class=nx>constructor</span> <span class=p>(</span><span class=nx>options</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>options</span> <span class=o>=</span> <span class=nx>options</span>
        <span class=c1>// 将options中传入的routes解析出来存入到routeMap对象中
</span><span class=c1></span>        <span class=c1>// {url:component} 键值对
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>routeMap</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=c1>// data应该是响应式的对象 
</span><span class=c1></span>        <span class=c1>// vue提供一个observable()方法创建响应式对象
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>data</span> <span class=o>=</span> <span class=nx>_Vue</span><span class=p>.</span><span class=nx>observable</span><span class=p>({</span>
            <span class=nx>current</span><span class=o>:</span><span class=s1>&#39;/&#39;</span> <span class=c1>// current存储当前路由地址
</span><span class=c1></span>        <span class=p>})</span> 
    <span class=p>}</span>
</code></pre></td></tr></table></div></div><h3 id=createroutemap>createRouteMap</h3><p>该方法作用: 将构造函数传入的options中的routes路由规则转换为键值对形式,存入到routeMap对象里</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>createRouteMap</span> <span class=p>()</span> <span class=p>{</span>
    <span class=c1>// 遍历所有的路由规则, 把路由规则解析成键值对的形式, 存储到routeMap中
</span><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>routes</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>route</span> <span class=p>=&gt;</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>routeMap</span><span class=p>[</span><span class=nx>route</span><span class=p>.</span><span class=nx>path</span><span class=p>]</span> <span class=o>=</span> <span class=nx>route</span><span class=p>.</span><span class=nx>component</span>
    <span class=p>})</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><h3 id=inicomponents>iniComponents</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js>    <span class=nx>iniComponents</span> <span class=p>(</span><span class=nx>Vue</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// 1. template模板形式 需要compiler
</span><span class=c1></span>        <span class=c1>// Vue.component(&#39;router-link&#39;, {
</span><span class=c1></span>        <span class=c1>//     props: {
</span><span class=c1></span>        <span class=c1>//         to: String
</span><span class=c1></span>        <span class=c1>//     },
</span><span class=c1></span>        <span class=c1>//     template: &#39;&lt;a :href=&#34;to&#34;&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/a&gt;&#39;
</span><span class=c1></span>        <span class=c1>// })
</span><span class=c1></span>        <span class=c1>// 2. 手写render函数
</span><span class=c1></span>        <span class=nx>Vue</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;router-link&#39;</span><span class=p>,</span> <span class=p>{</span>
            <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
                <span class=nx>to</span><span class=o>:</span> <span class=nb>String</span>
            <span class=p>},</span>
            <span class=c1>// h: h函数作用:创建虚拟dom, 三个参数
</span><span class=c1></span>            <span class=c1>// 1. 选择器,对应标签名字
</span><span class=c1></span>            <span class=c1>// 2. 对创建的dom对象设置一些属性
</span><span class=c1></span>            <span class=c1>// 3. 可以设置生成的a标签的子元素
</span><span class=c1></span>            <span class=nx>render</span> <span class=p>(</span><span class=nx>h</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>return</span> <span class=nx>h</span> <span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=p>{</span>
                    <span class=nx>attrs</span><span class=o>:</span> <span class=p>{</span>
                        <span class=nx>href</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span>
                    <span class=p>}</span>
                <span class=p>},</span> <span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>$slots</span><span class=p>.</span><span class=k>default</span><span class=p>])</span>
            <span class=p>}</span>
        <span class=p>})</span>
    <span class=p>}</span>

    <span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>createRouteMap</span><span class=p>()</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>iniComponents</span><span class=p>(</span><span class=nx>_Vue</span><span class=p>)</span>
    <span class=p>}</span>
</code></pre></td></tr></table></div></div><p>PS: Vue的构建版本</p><ul><li>运行时版: 不支持 template 模板, 需要打包的时候提前编译</li><li>完整版 : 包含运行时和编译器, 体积比运行时版大10k左右, 在程序运行时的时候把模板转换成render函数</li><li>Vue-cli创建的项目默认使用的是运行时runtime版本</li><li>Runtime + Compiler开启</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=c1>// 根文件下创建vue.config.js
</span><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
 <span class=nx>runtimeCompiler</span><span class=o>:</span> <span class=kc>true</span> 
<span class=p>}</span>
</code></pre></td></tr></table></div></div><h3 id=router-view>router-view</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>iniComponents</span> <span class=p>(</span><span class=nx>Vue</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Vue.component(&#39;router-link&#39;, {
</span><span class=c1></span>    <span class=c1>//     props: {
</span><span class=c1></span>    <span class=c1>//         to: String
</span><span class=c1></span>    <span class=c1>//     },
</span><span class=c1></span>    <span class=c1>//     template: &#39;&lt;a :href=&#34;to&#34;&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/a&gt;&#39;
</span><span class=c1></span>    <span class=c1>// })
</span><span class=c1></span>    <span class=nx>Vue</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;router-link&#39;</span><span class=p>,</span> <span class=p>{</span>
        <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
            <span class=nx>to</span><span class=o>:</span> <span class=nb>String</span>
        <span class=p>},</span>
        <span class=c1>// h: h函数作用:创建虚拟dom, 三个参数
</span><span class=c1></span>        <span class=nx>render</span> <span class=p>(</span><span class=nx>h</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nx>h</span> <span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=p>{</span>
                <span class=nx>attrs</span><span class=o>:</span> <span class=p>{</span>
                    <span class=nx>href</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span>
                <span class=p>},</span>
                <span class=nx>on</span><span class=o>:</span> <span class=p>{</span>
                    <span class=nx>click</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>clickHandler</span> <span class=c1>// 注册事件不用加()
</span><span class=c1></span>                <span class=p>}</span>
            <span class=p>},</span> <span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>$slots</span><span class=p>.</span><span class=k>default</span><span class=p>])</span>
        <span class=p>},</span>
        <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
            <span class=nx>clickHandler</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
                <span class=c1>// 第一个data:将来触发popstate的,暂时不用  title:&#39;&#39;
</span><span class=c1></span>                <span class=c1>// 改变地址栏
</span><span class=c1></span>                <span class=nx>history</span><span class=p>.</span><span class=nx>pushState</span><span class=p>({},</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span><span class=p>)</span>
                <span class=c1>// 响应式, 会触发下面的组件重新渲染
</span><span class=c1></span>                <span class=k>this</span><span class=p>.</span><span class=nx>$router</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span>
                <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>()</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>})</span>

    <span class=kr>const</span> <span class=nx>self</span> <span class=o>=</span> <span class=k>this</span> <span class=c1>// self 是VueRouter的实例
</span><span class=c1></span>    <span class=nx>Vue</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;router-view&#39;</span><span class=p>,</span> <span class=p>{</span>
        <span class=nx>render</span> <span class=p>(</span><span class=nx>h</span><span class=p>)</span> <span class=p>{</span>
            <span class=c1>// 获取当前路由对应的组件
</span><span class=c1></span>            <span class=kr>const</span> <span class=nx>component</span> <span class=o>=</span> <span class=nx>self</span><span class=p>.</span><span class=nx>routeMap</span><span class=p>[</span><span class=nx>self</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span><span class=p>]</span>
            <span class=k>return</span> <span class=nx>h</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
        <span class=p>}</span>
    <span class=p>})</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><h3 id=initevent>initEvent</h3><p>点击浏览器的前进后退时, 也触发组件重新渲染</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>initEvent</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;popstate&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
        <span class=c1>// 这里的this就是initEvent里的this, 即VueRouter对象
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>pathname</span>
    <span class=p>})</span>
<span class=p>}</span>

<span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>createRouteMap</span><span class=p>()</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>iniComponents</span><span class=p>(</span><span class=nx>_Vue</span><span class=p>)</span>
    <span class=k>this</span><span class=p>.</span><span class=nx>initEvent</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><h2 id=total-source>total source</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=kd>let</span> <span class=nx>_Vue</span> <span class=o>=</span> <span class=kc>null</span>
<span class=kr>class</span> <span class=nx>VueRouter</span> <span class=p>{</span>
    <span class=nx>constructor</span> <span class=p>(</span><span class=nx>options</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>options</span> <span class=o>=</span> <span class=nx>options</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>routeMap</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>data</span> <span class=o>=</span> <span class=nx>_Vue</span><span class=p>.</span><span class=nx>observable</span><span class=p>({</span>
            <span class=nx>current</span><span class=o>:</span><span class=s1>&#39;/&#39;</span> <span class=c1>// current存储当前路由地址
</span><span class=c1></span>        <span class=p>})</span> <span class=c1>// vue创建响应式对象
</span><span class=c1></span>    <span class=p>}</span>

    <span class=kr>static</span> <span class=nx>install</span> <span class=p>(</span><span class=nx>Vue</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// 1. 判断当前插件是否已经被安装
</span><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>VueRouter</span><span class=p>.</span><span class=nx>install</span><span class=p>.</span><span class=nx>installed</span><span class=p>)</span> <span class=k>return</span>
        <span class=nx>VueRouter</span><span class=p>.</span><span class=nx>install</span><span class=p>.</span><span class=nx>installed</span> <span class=o>=</span> <span class=kc>true</span>
        <span class=c1>// 2. 把Vue构造函数记录到全局变量
</span><span class=c1></span>        <span class=nx>_Vue</span> <span class=o>=</span> <span class=nx>Vue</span>
        <span class=c1>// 3. 把创建Vue实例时候传入的router对象注入到Vue实例上
</span><span class=c1></span>        <span class=c1>// _Vue.prototype.$router = this.$options.router
</span><span class=c1></span>        <span class=c1>// 混入
</span><span class=c1></span>        <span class=nx>_Vue</span><span class=p>.</span><span class=nx>mixin</span><span class=p>({</span>
            <span class=nx>beforeCreate</span><span class=p>()</span> <span class=p>{</span>
                <span class=c1>// 如果是Vue实例执行,组件就不执行了
</span><span class=c1></span>                <span class=c1>// 只有Vue实例的$options里才有router对象
</span><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>$options</span><span class=p>.</span><span class=nx>router</span><span class=p>)</span> <span class=p>{</span>
                    <span class=nx>_Vue</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>$router</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>$options</span><span class=p>.</span><span class=nx>router</span>

                    <span class=k>this</span><span class=p>.</span><span class=nx>$options</span><span class=p>.</span><span class=nx>router</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span> <span class=c1>// 调用init方法
</span><span class=c1></span>                <span class=p>}</span>
            <span class=p>},</span>
        <span class=p>})</span>
    <span class=p>}</span>

    <span class=nx>init</span> <span class=p>()</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>createRouteMap</span><span class=p>()</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>iniComponents</span><span class=p>(</span><span class=nx>_Vue</span><span class=p>)</span>
        <span class=k>this</span><span class=p>.</span><span class=nx>initEvent</span><span class=p>()</span>
    <span class=p>}</span>

    <span class=nx>createRouteMap</span> <span class=p>()</span> <span class=p>{</span>
        <span class=c1>// 遍历所有的路由规则, 把路由规则解析成键值对的形式, 存储到routeMap中
</span><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>routes</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>route</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=k>this</span><span class=p>.</span><span class=nx>routeMap</span><span class=p>[</span><span class=nx>route</span><span class=p>.</span><span class=nx>path</span><span class=p>]</span> <span class=o>=</span> <span class=nx>route</span><span class=p>.</span><span class=nx>component</span>
        <span class=p>})</span>
    <span class=p>}</span>

    <span class=nx>iniComponents</span> <span class=p>(</span><span class=nx>Vue</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Vue.component(&#39;router-link&#39;, {
</span><span class=c1></span>        <span class=c1>//     props: {
</span><span class=c1></span>        <span class=c1>//         to: String
</span><span class=c1></span>        <span class=c1>//     },
</span><span class=c1></span>        <span class=c1>//     template: &#39;&lt;a :href=&#34;to&#34;&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/a&gt;&#39;
</span><span class=c1></span>        <span class=c1>// })
</span><span class=c1></span>        <span class=nx>Vue</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;router-link&#39;</span><span class=p>,</span> <span class=p>{</span>
            <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
                <span class=nx>to</span><span class=o>:</span> <span class=nb>String</span>
            <span class=p>},</span>
            <span class=c1>// h: h函数作用:创建虚拟dom, 三个参数
</span><span class=c1></span>            <span class=nx>render</span> <span class=p>(</span><span class=nx>h</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>return</span> <span class=nx>h</span> <span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=p>{</span>
                    <span class=nx>attrs</span><span class=o>:</span> <span class=p>{</span>
                        <span class=nx>href</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span>
                    <span class=p>},</span>
                    <span class=nx>on</span><span class=o>:</span> <span class=p>{</span>
                        <span class=nx>click</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>clickHandler</span> <span class=c1>// 注册事件不用加()
</span><span class=c1></span>                    <span class=p>}</span>
                <span class=p>},</span> <span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>$slots</span><span class=p>.</span><span class=k>default</span><span class=p>])</span>
            <span class=p>},</span>
            <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
                <span class=nx>clickHandler</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
                    <span class=c1>// 第一个data:将来触发popstate的,暂时不用  title:&#39;&#39;
</span><span class=c1></span>                    <span class=c1>// 改变地址栏
</span><span class=c1></span>                    <span class=nx>history</span><span class=p>.</span><span class=nx>pushState</span><span class=p>({},</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span><span class=p>)</span>
                    <span class=c1>// 响应式, 会触发下面的组件重新渲染
</span><span class=c1></span>                    <span class=k>this</span><span class=p>.</span><span class=nx>$router</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>to</span>
                    <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>()</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>})</span>

        <span class=kr>const</span> <span class=nx>self</span> <span class=o>=</span> <span class=k>this</span> <span class=c1>// self 是VueRouter的实例
</span><span class=c1></span>        <span class=nx>Vue</span><span class=p>.</span><span class=nx>component</span><span class=p>(</span><span class=s1>&#39;router-view&#39;</span><span class=p>,</span> <span class=p>{</span>
            <span class=nx>render</span> <span class=p>(</span><span class=nx>h</span><span class=p>)</span> <span class=p>{</span>
                <span class=c1>// 获取当前路由对应的组件
</span><span class=c1></span>                <span class=kr>const</span> <span class=nx>component</span> <span class=o>=</span> <span class=nx>self</span><span class=p>.</span><span class=nx>routeMap</span><span class=p>[</span><span class=nx>self</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span><span class=p>]</span>
                <span class=k>return</span> <span class=nx>h</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=p>})</span>
    <span class=p>}</span>

    <span class=nx>initEvent</span> <span class=p>()</span> <span class=p>{</span>
        <span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;popstate&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=c1>// 这里的this就是initEvent里的this, 即VueRouter对象
</span><span class=c1></span>            <span class=k>this</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>pathname</span>
        <span class=p>})</span>
    <span class=p>}</span>

<span class=p>}</span>

<span class=kr>export</span> <span class=k>default</span> <span class=nx>VueRouter</span>
</code></pre></td></tr></table></div></div></div></article></div></div></main><footer id=footer class=footer><div class=copyright><span class=copyright-year>&copy;
2020 -
2021<span class=heart>
<i class="fa fa-heartbeat"></i></span><span class=z-author>zxd</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script><script>if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));else{const a=document.createElement("style"),b=`
                    @media screen and (min-width: 750px){
                            img[src*="#w90"] {
                            width: 90% !important;
                            }
                            
                            img[src*="#w80"] {
                            width: 80% !important;
                            }
                            
                            img[src*="#w70"] {
                            width: 70% !important;
                            }
                            
                            img[src*="#w60"] {
                            width: 60% !important;
                            }
                            
                            img[src*="#w50"] {
                            width: 50% !important;
                            }
                            
                            img[src*="#w40"] {
                            width: 40% !important;
                            }
                            img[src*="#w30"] {
                            width: 30% !important;
                            }
                        }
                    `;try{a.appendChild(document.createTextNode(b))}catch(c){a.styleSheet.cssText=b}document.getElementsByTagName("head")[0].appendChild(a)}</script></body></html>