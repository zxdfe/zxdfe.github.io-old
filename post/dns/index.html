<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>DNS - Zxd's Blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="zxd"><meta name=description content="HTTP HTTP (HyperText Transfer Protocol)，超文本传输协议。 HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。 CDN Content Delivery Network,"><meta name=keywords content="Hugo,theme,Zxd"><meta name=generator content="Hugo 0.81.0 with theme even"><link rel=canonical href=http://localhost:1313/post/dns/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><link href=/sass/main.min.8eca1510e0bf04006a123f0d7fcb8799b6e77ab2f264b44357a16e783b064b04.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="DNS"><meta property="og:description" content="HTTP HTTP (HyperText Transfer Protocol)，超文本传输协议。 HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。 CDN Content Delivery Network,"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/post/dns/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-12-10T17:40:54+08:00"><meta property="article:modified_time" content="2021-12-10T17:40:54+08:00"><meta itemprop=name content="DNS"><meta itemprop=description content="HTTP HTTP (HyperText Transfer Protocol)，超文本传输协议。 HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。 CDN Content Delivery Network,"><meta itemprop=datePublished content="2021-12-10T17:40:54+08:00"><meta itemprop=dateModified content="2021-12-10T17:40:54+08:00"><meta itemprop=wordCount content="2469"><meta itemprop=keywords content="DNS,"><meta name=twitter:card content="summary"><meta name=twitter:title content="DNS"><meta name=twitter:description content="HTTP HTTP (HyperText Transfer Protocol)，超文本传输协议。 HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范。 CDN Content Delivery Network,"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>zxd's blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/vue/><li class=mobile-menu-item>Vue</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>zxd's blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/vue/>Vue</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>DNS</h1><div class=post-meta><span class=post-time>2021-12-10</span>
<span class=more-meta>2469 words</span>
<span class=more-meta>5 mins read</span></div></header><div class=post-toc id=post-toc><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#http>HTTP</a></li><li><a href=#cdn>CDN</a></li><li><a href=#web-service>Web Service</a></li><li><a href=#waf>WAF</a></li><li><a href=#uri-url>URI URL</a></li><li><a href=#https>HTTPS</a></li><li><a href=#代理>代理</a></li><li><a href=#dns>🔥DNS</a></li><li><a href=#mac>MAC</a></li></ul></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></div></div><div class=post-content><h3 id=http>HTTP</h3><p>HTTP (HyperText Transfer Protocol)，<strong>超文本传输协议</strong>。</p><p>HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等<strong>超文本</strong>数据的约定和规范。</p><h3 id=cdn>CDN</h3><p>Content Delivery Network, 内容分发网络。它<strong>应用了HTTP协议里的缓存和代理技术，代替源站响应客户端的请求</strong>。</p><p>它可以缓存源站的数据，让浏览器的请求不用“千里迢迢”地到达源站服务器， 直接在“半路”就可以获取响应。如果 CDN 的调度算法很优秀，更可以找到离用户最近的节点，大幅度缩短响应时间。</p><p>CDN位于浏览器和服务器之间，主要起到缓存加速的作用。</p><h3 id=web-service>Web Service</h3><p>由W3C定义的应用服务开发规范，使用Client-Server主从架构，通常使用 WSDL 定义服务接口，使用 HTTP 协议传输 XML 或 SOAP 消息，也就是说，它是<strong>一个基于 Web（HTTP）的服务架构技术</strong>，既可以运行在内网，也可以在适当保护后运行在外网。</p><h3 id=waf>WAF</h3><p>网络应用防火墙。与硬件“防火墙”类似，它是应用层面的“防火墙”，专门检测 HTTP 流量，是防护 Web 应用的安全技术。</p><p>WAF 通常位于 Web 服务器之前，可以阻止如 SQL 注入、跨站脚本等攻击，目前应用较多的一个开源项目是 ModSecurity，它能够完全集成进 Apache 或 Nginx。</p><h3 id=uri-url>URI URL</h3><p>DNS 和 IP 地址标记了互联网上的主机，URI标记的是我们到底要找哪个文件。</p><p>URI（Uniform Resource Identifier）统一资源<strong>标识</strong>符，使用它就能够唯一地标记互联网上的资源</p><p>URL（Uniform Resource Locator）统一资源<strong>定位符</strong>，也就是我们常说的网址，它实际上是URI的子集，但两者几乎相同，差异不大，通常不会做严格区分，可能写论文需要区分。</p><p>URI 是用来标记互联网上资源的一个名字，由“<strong>协议名 + 主机名 + 路径</strong>”构成，俗称 URL</p><p>URI 是统一资源标识符，标定了客户端需要访问的资源所处的位置，如果URI中的主机名使用域名，则需要使用DNS来讲域名解析为IP。</p><h3 id=https>HTTPS</h3><p>HTTP over SSL/TLS，<strong>运行在 SSL/TLS 协议上的HTTP</strong>。</p><p>SSL/TLS 是一个负责加密通信的安全协议，建立在 TCP/IP 之上。</p><p><strong>SSL 的全称是“ Secure Socket Layer ”</strong>，由网景公司发明，当发展到 3.0 时被标准化，<strong>改名为 TLS，即“Transport Layer Security”</strong>，但由于历史的原因还是有很多人称之为SSL/TLS，或者直接简称为 SSL。</p><p>HTTPS 相当于**“HTTP+SSL/TLS+TCP/IP**”，为 HTTP 套了一个安全的外壳；</p><h3 id=代理>代理</h3><p>代理（Proxy）是 HTTP 协议中请求方和应答方中间的一个环节，作为“中转站”，既可以转发客户端的请求，也可以转发服务器的应答。</p><p>代理有很多的种类，常见的有：</p><ol><li>匿名代理：完全“隐匿”了被代理的机器，外界看到的只是代理服务器；</li><li>透明代理：顾名思义，它在传输过程中是“透明开放”的，外界既知道代理，也知道客
户端；</li><li>正向代理：靠近客户端，代表客户端向服务器发送请求；</li><li>反向代理：靠近服务器端，代表服务器响应客户端的请求；</li></ol><p>CDN，实际上就是一种代理，它代替源站服务器响应客户端的请求，通常扮演着透明代理和反向代理的角色。</p><p>由于代理在传输过程中插入了一个“中间层”，所以可以在这个环节做很多有意思的事情， 比如：</p><ol><li><p>负载均衡：把访问请求均匀分散到多台机器，实现访问集群化；</p></li><li><p>内容缓存：暂存上下行的数据，减轻后端的压力；</p></li><li><p>安全防护：隐匿 IP, 使用 WAF 等工具抵御网络攻击，保护被代理的机器；</p></li><li><p>数据处理：提供压缩、加密等额外的功能。</p></li></ol><h3 id=dns>🔥DNS</h3><p>Domain Name System 域名系统， 是互联网使用的命名系统，用来把便于人们使用的域名转换为IP地址。<strong>域名是大小写无关的</strong>。</p><p>互联网的域名系统DNS被设计成一个联机<strong>分布式数据库系统</strong>，并采用客户服务器方式。</p><p><strong>域名到IP地址的解析</strong>是由分布在互联网上的许多域名服务程序（简称<strong>域名服务器</strong>）共同完成的。</p><p>DNS的核心系统是一个三层的树状、分布式服务。对应域名的结构：</p><ol><li><strong>根域名服务器 （Root DNS Server）</strong><ul><li>管理顶级域名服务器，返回“com” “net” “cn”等顶级域名服务器的 IP 地址；</li><li>全世界目前有13组根域名服务器，又有数百台镜像。</li></ul></li><li><strong>顶级域名服务器（Top-level DNS Server）</strong><ul><li>管理各自域名下的权威域名服务器，比如 com 顶级域名服务器可以返回 apple.com 域名服务器的 IP 地址；</li></ul></li><li><strong>权威域名服务器（Authoritative DNS Server）</strong><ul><li>管理自己域名下主机的 IP 地址，比如 apple.com 权威域名服务器可以返回 <a href=http://www.apple.com>www.apple.com</a> 的 IP 地址。</li></ul></li></ol><p>除了上面三种DNS服务器，还有一种不在DNS层次结构之中，但是很重要的DNS服务器，就是<strong>本地域名服务器</strong>（也被称为<strong>权威域名服务器</strong>）。本地域名服务器是电脑解析时的<strong>默认</strong>域名服务器，即电脑中设置的首选 DNS 服务器和备选 DNS 服务器。常见的有电信、联通、谷歌、阿里等的本地 DNS 服务。</p><h4 id=dns解析过程>DNS解析过程</h4><p>把<strong>域名映射到IP</strong>的过程，叫做<strong>域名解析</strong>。此过程是 计网7 中摘录。 真实情况要考虑缓存等。</p><p>域名到IP地址的解析过程要点如下：</p><p>当某一个应用进程需要把主机名解析为IP地址时，</p><ol><li>该应用进程就调用<strong>解析程序（resolver）</strong>，并成为DNS的一个客户，</li><li>把待解析的域名放在DNS请求报文中，以<strong>UDP 用户数据报</strong>的格式发送给本地域名服务器（使用 UDP 是为了减少开销）。</li><li>本地域名服务器在查找域名后，把对应的IP地址放在响应报文中返回。</li></ol><h4 id=dns解析过程考虑缓存>🔥DNS解析过程考虑缓存：</h4><ol><li>首先搜索<strong>浏览器DNS缓存</strong>，缓存中维护一张域名与IP地址的对应表。</li><li>如果没有命中，<strong>系统DNS缓存</strong>。 Mac上 <code>nslookup www.baidu.com</code>可以查看系统缓存</li><li>hosts文件</li><li>路由器缓存</li><li>本地域名服务器（ISP）</li><li>根域名服务器</li><li>顶级域名服务器</li><li>权威名服务器</li></ol><h4 id=dns查询过程>🔥DNS查询过程</h4><p>DNS的查询过程，按查询方式不同，分为<strong>递归查询 和 迭代查询</strong>。</p><p><strong>递归查询：</strong></p><p><img src=https://zxd-blog-imgs.oss-cn-beijing.aliyuncs.com/imgs/20211209194714.png alt=image-20211209194713872 style=zoom:50%></p><p><strong>迭代查询:</strong></p><p><img src=https://zxd-blog-imgs.oss-cn-beijing.aliyuncs.com/imgs/20211209194750.png alt=image-20211209194750785 style=zoom:50%></p><p>在实际的网络中，一般采用两段式查询过程，即先递归，后迭代。从本地主机到本地域名服务器采用递归查询，而从本地域名服务器到最终结果则采用迭代方式查询</p><p>递归查询：<strong>主机和本地域名服务器之间的查询方式是递归查询。</strong></p><p>迭代查询：<strong>本地域名服务器和其他域名服务器之间的查询方式是迭代查询</strong>，防止根域名服务器压力过大。</p><h3 id=mac>MAC</h3><p>MAC地址 （Media Access Control Address）, 也称为局域网地址，可以唯一地标识一个网卡，也就同时标识了此网卡所属的设备。</p><p>IP 地址必须转换成MAC地址才能访问主机。</p><h2 id=参考>参考</h2><ol><li>透视HTTP协议 from GeekTime</li><li>Web协议详解与抓包实战</li><li>计算机网络 第7版 谢希仁</li><li><a href=https://juejin.cn/post/6919755385330991112>超详细 DNS 协议解析</a></li><li><a href=https://github.com/qiu-deqing/FE-interview>https://github.com/qiu-deqing/FE-interview</a></li></ol></div><footer class=post-footer><div class=post-tags><a href=/tags/dns/>DNS</a></div><nav class=post-nav><a class=next href=/post/2021-12-09-tcp-udp/><span class="next-text nav-default">TCP UDP</span>
<span class="next-text nav-mobile">Next</span>
<i class="fa fa-long-arrow-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=copyright><span class=copyright-year>&copy;
2020 -
2021<span class=heart>
<i class="fa fa-heartbeat"></i></span><span class=z-author>zxd</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script><script>if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));else{const a=document.createElement("style"),b=`
                    @media screen and (min-width: 750px){
                            img[src*="#w90"] {
                            width: 90% !important;
                            }
                            
                            img[src*="#w80"] {
                            width: 80% !important;
                            }
                            
                            img[src*="#w70"] {
                            width: 70% !important;
                            }
                            
                            img[src*="#w60"] {
                            width: 60% !important;
                            }
                            
                            img[src*="#w50"] {
                            width: 50% !important;
                            }
                            
                            img[src*="#w40"] {
                            width: 40% !important;
                            }
                            img[src*="#w30"] {
                            width: 30% !important;
                            }
                        }
                    `;try{a.appendChild(document.createTextNode(b))}catch(c){a.styleSheet.cssText=b}document.getElementsByTagName("head")[0].appendChild(a)}</script></body></html>